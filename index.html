<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Buy $RONNY</title>
    <style>
        @font-face {
            font-family: 'NegritaPro';
            src: url('NegritaPro.woff2') format('woff2'),
                 url('NegritaPro.woff') format('woff');
        }

        body {
            font-family: 'NegritaPro', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #5FA2C7;
        }

        .container {
            background-color: #FEFE84;
            padding: 15px;
            border-radius: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'NegritaPro', Arial, sans-serif;
            text-align: center;
            width: 300px;
        }

        #connectWallet, #disconnectWallet, #buyRonnyButton {
            background-color: black;
            color: white;
            padding: 10px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-bottom: 10px;
        }

        .input-group {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .input-group div {
            width: 48%;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .wallet-address {
            word-break: break-all;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="$RONNYwnobg.png" alt="$RONNY" style="width: 100px; height: 100px; margin-bottom: 10px;">
        <h1>BUY $RONNY BEFORE LAUNCH!</h1>
        <button id="connectWallet">Connect Wallet</button>
        <button id="disconnectWallet" class="hidden">Disconnect Wallet</button>
        <div class="input-group">
            <div>
                <label for="amountSol">Amount in SOL</label>
                <input type="text" id="amountSol" placeholder="0.00">
            </div>
            <div>
                <label for="amountRonny">Amount in $RONNY</label>
                <input type="text" id="amountRonny" placeholder="0.00" readonly>
            </div>
        </div>
        <button id="buyRonnyButton">BUY $RONNY!</button>
        <div id="walletAddress" class="wallet-address"></div>
        <div id="userRonny">Your $RONNY: 0 $RONNY Coins</div>
        <div>Total Raised: <span id="totalRaised">0</span> SOL</div>
        <div>You may also send Sol to this address to participate in the presale: G1ZVYuQn43GC31yatJS5FupodNVMAiuyR8QHNhWZRhHG</div>
    </div>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script>
        const recipientWalletAddress = 'G1ZVYuQn43GC31yatJS5FupodNVMAiuyR8QHNhWZRhHG';
        const RONNY_PER_SOL = 6969;
        let account;

        document.getElementById('connectWallet').addEventListener('click', async () => {
            try {
                const resp = await window.solana.connect();
                account = resp.publicKey.toString();
                document.getElementById('walletAddress').textContent = 'Connected wallet: ' + account;
                document.getElementById('connectWallet').classList.add('hidden');
                document.getElementById('disconnectWallet').classList.remove('hidden');
            } catch (err) {
                console.error(err);
            }
        });

        document.getElementById('disconnectWallet').addEventListener('click', async () => {
            window.solana.disconnect();
            document.getElementById('walletAddress').textContent = '';
            document.getElementById('connectWallet').classList.remove('hidden');
            document.getElementById('disconnectWallet').classList.add('hidden');
        });

        document.getElementById('amountSol').addEventListener('input', () => {
            const solAmount = parseFloat(document.getElementById('amountSol').value);
            document.getElementById('amountRonny').value = solAmount * RONNY_PER_SOL;
        });

        document.getElementById('buyRonnyButton').addEventListener('click', async () => {
            await buyRonny();
        });

        async function buyRonny() {
            const connection = new solanaWeb3.Connection(
                "https://restless-necessary-wildflower.solana-mainnet.quiknode.pro/ffe17014aa5c31cf44834cca6e29e4099a05a82a/",
                "confirmed"
            );

            const fromPublicKey = new solanaWeb3.PublicKey(account);
            const toPublicKey = new solanaWeb3.PublicKey(recipientWalletAddress);
            const amountInLamports = solanaWeb3.LAMPORTS_PER_SOL * parseFloat(document.getElementById("amountSol").value);

            let transaction = new solanaWeb3.Transaction().add(
                solanaWeb3.SystemProgram.transfer({
                    fromPubkey: fromPublicKey,
                    toPubkey: toPublicKey,
                    lamports: amountInLamports,
                })
            );

            const { blockhash } = await connection.getRecentBlockhash("finalized");
            transaction.recentBlockhash = blockhash;
            transaction.feePayer = fromPublicKey;

            try {
                let signedTransaction = await window.solana.signTransaction(transaction);
                let signature = await connection.sendRawTransaction(signedTransaction.serialize());
                await connection.confirmTransaction(signature, "confirmed");
                alert("Transaction successful!");
            } catch (error) {
                console.error("Transaction Error:", error);
                alert("Transaction failed. Please try again.");
            }
        }
    </script>
</body>
</html>
